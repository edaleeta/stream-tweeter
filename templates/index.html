{% extends 'base.html' %}

{% block title %}| Home{% endblock %}

{% block page_content %}
    <p>
        Welcome
        {%- if current_user.is_authenticated %}
            {{ current_user.twitch_displayname }}
        {%- endif -%}
        !
    </p>
    {% if current_user.is_authenticated %}
        <div>
            <h2>Your Tweet Templates</h2>
            <ul>
                {% for template in current_user.templates %}
                    <li>
                        <button type="submit" class="del-tweet-button" value="{{ template.template_id }}">
                            Delete
                        </button>
                        <button type="submit">Edit</button>    
                        {{ template.contents }}
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% block add_tweet_temp %}
            ADD TWEET TEMPLATE FORM HERE.
        {% endblock %}
    {% endif %}
    {% if not current_user.is_authenticated and "current_twitch_user" not in session %}
        <a href="/login">Please sign in here.</a>
    {% endif %}
{% endblock %}

<!-- Move this later. -->
{% block custom_javascript %}
<script>
    $(document).ready(function(){
        $(".del-tweet-button").click(deleteTweet)
    });

    function deleteTweet(e){
        // Send the value of this button to route delete-tweet-template
        console.log(e);
        let template_id = e.target.value
        let payload = { "template_id": template_id }
        $.post("/delete-tweet-template", payload)
    }
</script>
{% endblock %}