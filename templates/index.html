{% extends 'base.html' %}
{% from 'macros.html' import tweet_template_list %}

{% block title %}| Home{% endblock %}

{% block page_content %}
    <p>
        Welcome
        {%- if current_user.is_authenticated %}
            {{ current_user.twitch_displayname }}
        {%- endif -%}
        !
    </p>
    {% if current_user.is_authenticated %}
        <div>
            <h2>Your Tweet Templates</h2>
            <div id="tweet_templates">
                {{ tweet_template_list(current_user) }}
            </div>
        </div>
        {% block add_tweet_temp %}
            ADD TWEET TEMPLATE FORM HERE.
        {% endblock %}
    {% endif %}
    {% if not current_user.is_authenticated and "current_twitch_user" not in session %}
        <a href="/login">Please sign in here.</a>
    {% endif %}
{% endblock %}

<!-- Move this later. -->
{% block custom_javascript %}
<script>
    $(document).ready(function(){
        $("#tweet_templates").on('click', ".del-tweet-button", deleteTweet);
    });

    function deleteTweet(e){
        // Send the value of this button to route delete-tweet-template
        console.log(e);
        let template_id = e.target.value
        let payload = { "template_id": template_id }
        $.post("/delete-tweet-template", payload, (result) => {
            $("#tweet_templates").html(result)
        });
    }
</script>
{% endblock %}